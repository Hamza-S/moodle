define(["jquery","core/ajax","core/templates"],function(a,b,c){var d=100;return{showMore:function(){d*=10},processResults:function(b,c){var d=[];return a.each(c,function(a,b){d.push({value:b.id,label:b._label})}),d},transport:function(e,f,g,h){var i,j=!1,k=a(e).attr("courseid");"undefined"==typeof k&&(k="1");var l=a(e).attr("enrolid");"undefined"==typeof l&&(l=""),i=b.call([{methodname:"core_enrol_get_potential_users",args:{courseid:k,enrolid:l,search:f,searchanywhere:!0,page:0,perpage:d+1}}]),i[0].then(function(b){var e=[],f=0;return b.length==d+1&&(b.pop(),j=!0),a.each(b,function(b,d){var f=d,g=[];a.each(["idnumber","email","phone1","phone2","department","institution"],function(a,b){"undefined"!=typeof d[b]&&""!==d[b]&&(f.hasidentity=!0,g.push(d[b]))}),f.identity=g.join(", "),e.push(c.render("enrol_manual/form-user-selector-suggestion",f))}),a.when.apply(a.when,e).then(function(){var c=arguments;a.each(b,function(a,b){b._label=c[f],f++}),g(b,j)})}).fail(h)}}});