YUI.add("moodle-atto_accessibilityhelper-button",function(e,t){M.atto_accessibilityhelper=M.atto_accessibilityhelper||{dialogue:null,display_ui:function(e,t){e.preventDefault(),M.editor_atto.is_active(t)||M.editor_atto.focus(t);var n;M.atto_accessibilityhelper.dialogue?n=M.atto_accessibilityhelper.dialogue:n=new M.core.dialogue({visible:!1,modal:!0,close:!0,draggable:!0}),n.set("bodyContent",M.atto_accessibilityhelper.get_form_content(t)),n.set("headerContent",M.util.get_string("pluginname","atto_accessibilityhelper")),n.render(),n.centerDialogue(),M.atto_link.resolve_anchors(),n.show(),M.atto_accessibilityhelper.dialogue=n},init:function(e){var t=M.util.image_url("e/visual_blocks","core");M.editor_atto.add_toolbar_button(e.elementid,"accessibilityhelper",t,e.group,this.display_ui);var n=M.editor_atto.get_toolbar_node(e.elementid),r=n.one(".screenreader_group");r&&r.addClass("accesshide"),r.on("blur",function(){this.addClass("accesshide")},r),r.on("focus",function(){this.removeClass("accesshide")},r)},image_selected:function(e,t){e.preventDefault(),M.atto_accessibilityhelper.dialogue.hide();var n=e.target.getData("sourceimage"),r=M.editor_atto.get_selection_from_node(n);M.editor_atto.selections[t]=r,M.editor_atto.focus(t)},list_images:function(t){var n=e.Node.create("<ol/>"),r=M.editor_atto.get_editable_node(t),i,s;return r.all("img").each(function(r){s=e.Node.create('<a href="#" title="'+M.util.get_string("selectimage","atto_accessibilityhelper")+'">'+e.Escape.html(r.getAttribute("alt"))+"</a>"),s.setData("sourceimage",r),s.on("click",this.image_selected,this,t),i=e.Node.create("<li></li>"),i.append(s),n.append(i)},this),n.hasChildNodes()||n.append("<li>"+M.util.get_string("noimages","atto_accessibilityhelper")+"</li>"),n},link_selected:function(e,t){e.preventDefault(),M.atto_accessibilityhelper.dialogue.hide();var n=e.target.getData("sourcelink"),r=M.editor_atto.get_selection_from_node(n);M.editor_atto.selections[t]=r,M.editor_atto.focus(t)},list_links:function(t){var n=e.Node.create("<ol/>"),r=M.editor_atto.get_editable_node(t),i,s;return r.all("a").each(function(r){s=e.Node.create('<a href="#" title="'+M.util.get_string("selectlink","atto_accessibilityhelper")+'">'+e.Escape.html(r.get("text"))+"</a>"),s.setData("sourcelink",r),s.on("click",this.link_selected,this,t),i=e.Node.create("<li></li>"),i.append(s),n.append(i)},this),n.hasChildNodes()||n.append("<li>"+M.util.get_string("nolinks","atto_accessibilityhelper")+"</li>"),n},list_styles:function(t){var n=[],r=M.editor_atto.get_selection_parent_node(),i=M.editor_atto.get_editable_node(t),s;r&&(r=e.one(r));while(r&&r!==i)s=r.get("tagName"),typeof s!="undefined"&&n.push(e.Escape.html(s)),r=r.ancestor();return n.length===0&&n.push(M.util.get_string("nostyles","atto_accessibilityhelper")),n.join(", ")},get_form_content:function(t){var n='<div><p for="atto_accessibilityhelper_styleslabel">'+M.util.get_string("liststyles","atto_accessibilityhelper")+"<br/>"+'<span id="atto_accessibilityhelper_liststyles" '+'aria-labelledby="atto_accessibilityhelper_styleslabel"/></p></div>',r=e.Node.create(n);return r.one("#atto_accessibilityhelper_liststyles").append(this.list_styles(t)),n='<p for="atto_accessibilityhelper_linkslabel">'+M.util.get_string("listlinks","atto_accessibilityhelper")+"<br/>"+'<span id="atto_accessibilityhelper_listlinks" '+'aria-labelledby="atto_accessibilityhelper_linkslabel"/></p>',r.append(n),r.one("#atto_accessibilityhelper_listlinks").append(this.list_links(t)),n='<p for="atto_accessibilityhelper_imageslabel">'+M.util.get_string("listimages","atto_accessibilityhelper")+"<br/>"+'<span id="atto_accessibilityhelper_listimages" '+'aria-labelledby="atto_accessibilityhelper_imageslabel"/></p>',r.append(n),r.one("#atto_accessibilityhelper_listimages").append(this.list_images(t)),r}}},"@VERSION@",{requires:["node","escape"]});
