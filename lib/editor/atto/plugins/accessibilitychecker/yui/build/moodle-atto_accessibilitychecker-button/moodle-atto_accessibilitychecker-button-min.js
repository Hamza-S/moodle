YUI.add("moodle-atto_accessibilitychecker-button",function(e,t){M.atto_accessibilitychecker=M.atto_accessibilitychecker||{dialogue:null,display_ui:function(e,t){e.preventDefault(),M.editor_atto.is_active(t)||M.editor_atto.focus(t);var n;M.atto_accessibilitychecker.dialogue?n=M.atto_accessibilitychecker.dialogue:n=new M.core.dialogue({visible:!1,modal:!0,close:!0,draggable:!0,width:"800px"}),n.set("bodyContent",M.atto_accessibilitychecker.get_form_content(t)),n.set("headerContent",M.util.get_string("pluginname","atto_accessibilitychecker")),n.render(),n.centerDialogue(),n.show(),M.atto_accessibilitychecker.dialogue=n},init:function(e){var t=M.util.image_url("e/visual_blocks","core");M.editor_atto.add_toolbar_button(e.elementid,"accessibilitychecker",t,e.group,this.display_ui)},add_warnings:function(t,n,r){var i,s,o,u,a;if(r.length>0){i=e.Node.create('<p class="warning">'+n+"</p>"),s=e.Node.create("<ol></ol"),o=0;for(o=0;o<r.length;o++)u=e.Node.create("<p></p>"),a=r[o].cloneNode(!0),a.removeAttribute("id"),u.append(a),s.append(e.Node.create("<li>"+e.Escape.html(u.getHTML())+"</li>"));i.append(s),t.append(i)}},list_warnings:function(t){var n=e.Node.create("<div></div>"),r=M.editor_atto.get_editable_node(t),i=[],s=[],o=[],u=[],a=/\.\w{0,3}$/,f;r.all("img").each(function(e){f=e.getAttribute("alt"),typeof f=="undefined"||f===""?i.push(e):a.test(f)&&s.push(e)},this),this.add_warnings(n,M.util.get_string("imagesmissingalt","atto_accessibilitychecker"),i),this.add_warnings(n,M.util.get_string("imagesaltnotmeaningful","atto_accessibilitychecker"),s);var l;r.all("a").each(function(e){l=e.get("text"),typeof l!="undefined"&&l!==""&&a.test(l)&&o.push(e)},this);var c,h,p,d,v;return r.all("*").each(function(t){t.get("text").trim()!==""&&(c=t.getComputedStyle("color"),h=t.getComputedStyle("backgroundColor"),h==="transparent"&&(h="rgb(255, 255, 255)"),p=e.Color.toArray(e.Color.toHSL(c)),d=e.Color.toArray(e.Color.toHSL(h)),p[2]>d[2]?v=(p[2]+.05)/(d[2]+.05):v=(d[2]+.05)/(p[2]+.05),v<=4.5&&u.push(t))},this),this.add_warnings(n,M.util.get_string("needsmorecontrast","atto_accessibilitychecker"),u),n.hasChildNodes()||n.append("<p>"+M.util.get_string("nowarnings","atto_accessibilitychecker")+"</p>"),n},get_form_content:function(t){var n='<div><p id="atto_accessibilitychecker_warningslabel">'+M.util.get_string("report","atto_accessibilitychecker")+"<br/>"+'<span id="atto_accessibilitychecker_listwarnings" '+'aria-labelledby="atto_accessibilitychecker_warningslabel"/></p></div>',r=e.Node.create(n);return r.one("#atto_accessibilitychecker_listwarnings").append(this.list_warnings(t)),r.one("#atto_accessibilitychecker_listwarnings").setStyle("wordWrap","break-word"),r}}},"@VERSION@",{requires:["node","escape","color-harmony"]});
