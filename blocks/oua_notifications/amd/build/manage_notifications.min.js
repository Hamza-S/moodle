define(["jquery","core/ajax","core/log","core/notification","core/templates","core/config","core/str","block_oua_notifications/jquery.blockUI"],function(a,b,c,d,e,f,g,h){var i,j=function(c){var e=b.call([{methodname:"block_oua_notifications_delete_notifications",args:{notificationids:c}}]);a.when.apply(a,e).done(function(b){b.notification_list&&(a("#notification_accordion").replaceWith(b.notification_list),a("#notification_count").change()),i&&a.isFunction(i.unblock)&&i.unblock()}).fail(d.exception)},k=function(){var b=a(".block_oua_notifications .accordion").attr("data-count");"0"===b&&(b=""),a(".user-navigation .block_oua_notifications .badge").text(b)};a("#notification_accordion").parent().on("click",".notification-delete",function(){var b=a(this),c=b.parents(".panel-body"),d=a("#confirm_delete_notification_dialog");d.appendTo(c),c.css("position","relative"),d.modal({backdrop:!0}),a(".confirm-delete",d).data("notificationid",[b.data("notificationid")]),a(".modal-backdrop.in").appendTo(c).css("bottom",0),a("body").removeClass("modal-open").css("padding-right",0)}).on("click",".confirm-delete",function(b){var c=a(this).data("notificationid");i=a("#notification_accordion").parent(),i.block({message:"<span class='glyphicon glyphicon-refresh glyphicon-refresh-animate spinning'></span>"}),j(c)}).on("click","a.dismissall",function(b){b.preventDefault();var c=a(this),d=c.parents(".panel-group"),e=a("#confirm_delete_all_notification_dialog");d.css("position","relative"),e.appendTo(d),e.modal({backdrop:!0}),a(".confirm-delete-all",e).data("notificationids",a(this).parents("#dismiss-all").data("dismissids")),a(".modal-backdrop.in").appendTo(d).css("bottom",0),a("body").removeClass("modal-open").css("padding-right",0)}).on("click",".confirm-delete-all",function(b){var c=a(this).data("notificationids");i=a("#notification_accordion").parent(),i.block({message:"<span class='glyphicon glyphicon-refresh glyphicon-refresh-animate spinning'></span>"}),j(c)}).on("change","#notification_count",function(){k()});var l=function(a){b.call([{methodname:"block_oua_notifications_mark_notification_read",args:{notificationid:a},fail:d.exception}])};return a("#notification_accordion").parent().on("click",".panel-heading.new-message",function(){var b=a("#notification_accordion").attr("data-count");b>0&&(a("#notification_accordion").attr("data-count",b-1),k()),a(this).removeClass("new-message");var c=a(this).attr("data-notificationid");l(c)}),a(document).ready(function(){k()}),{}});