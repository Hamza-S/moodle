define(["jquery","core/ajax","core/log","core/notification","core/templates","core/config","core/str"],function(a,b,c,d,e,f,g){var h=function(b,f){g.get_string("templateselected","tool_templatelibrary",b).done(function(b){a('[data-region="displaytemplateheader"]').text(b),a("html, body").animate({scrollTop:a('[data-region="displaytemplateheader"]').offset().top-80},200)}).fail(d.exception),a('[data-region="displaytemplatesource"]').text(f);var h=f.match(/Example context \(json\):([\s\S]*?)(}}|\n\n)/);c.debug(h);var i=!1;if(h){var j=h[1].trim();c.debug(j);try{i=a.parseJSON(j)}catch(k){c.debug("Could not parse json example context for template."),c.debug(k)}}i?(c.debug("Render template"+b),c.debug(i),e.render(b,i).done(function(b,c){a('[data-region="displaytemplateexample"]').empty(),a('[data-region="displaytemplateexample"]').append(b),e.runTemplateJS(c)}).fail(d.exception)):g.get_string("templatehasnoexample","tool_templatelibrary").done(function(b){a('[data-region="displaytemplateexample"]').text(b)}).fail(d.exception)},i=function(a){var c=a.split("/"),e=c.shift(),g=c.shift();b.call([{methodname:"core_output_load_template",args:{component:e,template:g,themename:f.theme},done:function(b){h(a,b)},fail:d.exception}])};return a('[data-region="list-templates"]').on("click","[data-templatename]",function(){var b=a(this).data("templatename");i(b)}),{}});